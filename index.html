<!DOCTYPE html>
<html>
  <head>
    <title>Assignment 3</title>
    <meta name="viewport" content="initial-scale=1.0">
    <meta charset="utf-8">
    <style>
      /* Always set the map height explicitly to define the size of the div
       * element that contains the map. */
      #map {
        height: 100%;
      }
      /* Optional: Makes the sample page fill the window. */
      html, body {
        height: 100%;
        margin: 0;
        padding: 0;
      }
	</style>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  </head>
  <body>

		<!DOCTYPE html>
		<html>
		<body>
		
		<p id="demo">Click the button to get your position.</p>
		
		<button onclick="getLocation()" id="find-location">Try It</button>
		
		<div id="mapholder"></div>
		
		<script>
		var x = document.getElementById("demo");
		
		alert("latlon: " + latlon);

		
		function getLocation() {
			if (navigator.geolocation) {
				navigator.geolocation.getCurrentPosition(showPosition, showError);
			} else {
				x.innerHTML = "Geolocation is not supported by this browser.";
			}
		}
		
		function showPosition(position) {
			var latlon = position.coords.latitude + "," + position.coords.longitude;
			var img_url = "https://maps.googleapis.com/maps/api/staticmap?center="+latlon+"&zoom=14&size=400x300&maptype=roadmap&markers=color:blue%7Clabel:YOU%7C"+latlon+"&key=AIzaSyAytNVu6CO-78ZdpgXfJqSAK-G-DEMbZuo";
			document.getElementById("mapholder").innerHTML = "<img src='"+img_url+"'>";
		}
		
		
		


		//To use this code on your website, get a free API key from Google.
		//Read more at: https://www.w3schools.com/graphics/google_maps_basic.asp
		
		function showError(error) {
			switch(error.code) {
				case error.PERMISSION_DENIED:
					x.innerHTML = "User denied the request for Geolocation."
					break;
				case error.POSITION_UNAVAILABLE:
					x.innerHTML = "Location information is unavailable."
					break;
				case error.TIMEOUT:
					x.innerHTML = "The request to get user location timed out."
					break;
				case error.UNKNOWN_ERROR:
					x.innerHTML = "An unknown error occurred."
					break;
			}
		}
		</script>
		
		


            <script type="text/javascript">
            
			$("#find-location").click(function (e) {
           
		   e.preventDefault();
            $.ajax({
              
              url: "https://maps.googleapis.com/maps/api/geocode/json?latlng="+latlon+"&key=AIzaSyAytNVu6CO-78ZdpgXfJqSAK-G-DEMbZuo",
              type: "GET",
              success: function (data) {
				console.log(data);
                
                if (data["status"] != "OK") {
                    
                    $("#message").html('<div class="alert alert-warning" role="alert">Postcode could not be found - please try again.</div>');
                    
                } else {
                
                $.each(data["results"][0]["address_components"], function (key, value) {
                    
                    if (value["types"][0] == "postal_code") {
                        
                    $("#message").html('<div class="alert alert-success" role="alert"><strong>Postcode found!</strong> The postcode is ' + value["long_name"] + '.</div>');
                    
                    }
                    
                })
                
                }
                
              }
              
            })
			})
</script>
    <!-- <div align = "center">
		<form action = "map.html" method = "get">
			Please enter your age:
			<input type="number" name="age"/>
			<input type="submit" value="Submit" />
		</form>
	</div> -->
  </body>
</html>